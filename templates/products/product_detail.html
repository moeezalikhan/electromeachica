{% extends 'base.html' %}
{% load static %}
{% block title %}Machenary - Product Details{% endblock %}
{% block content %}

<!-- Page Title -->
<style>
  .sku-badge {
    display: inline-block;
    padding: 4px 10px;
    background: #f0f0f0;
    color: #333;
    font-size: 13px;
    font-weight: 600;
    border-radius: 6px;
    border: 1px solid #ddd;
  }
</style>
<style>
.fancy-title {
    background: #f7f7f7;        /* light gray background */
    padding: 10px 15px;         /* thoda spacing */
    border-radius: 8px;          /* rounded corners */
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);  /* soft shadow */
    margin-bottom: 15px;         /* spacing from next element */
    text-align: center;           /* center align text */
    font-size: 18px;              /* thoda bada font */
    font-weight: 600;             /* bold text */
    color: #333;                  /* text color */
}


</style>

<section class="page-title" style="background-image:url({% static 'images/background/WhatsApp Image 2025-11-25 at 17.45.11_14746e71.jpg'%})">
        <div class="auto-container">
            <h1>{{ product.title }}</h1>
            <ul class="page-breadcrumb">
                <li><a href="{% url 'home'%}">Home</a></li>
                <li><a href="{% url 'products'%}">Products</a></li>
                 <li>{{ product.title }}</li>
            </ul>
        </div>
    </section>

<!-- Sidebar Page Container -->
<div class="sidebar-page-container">
  <div class="auto-container">
    <div class="row clearfix">

      <!-- Content Side -->
      <div class="content-side pull-right col-lg-9 col-md-8 col-sm-12 col-xs-12">
        <div class="shop-single">
          <div class="product-details">

            <!-- Product Images -->
            <div class="basic-details">
              <div class="row clearfix">
                <div class="image-column col-md-6 col-sm-6 col-xs-12">
                  {% if images %}
                  <div class="owl-carousel owl-theme single-item-carousel">
                    {% for image in images %}
                    <figure class="image-box">
                      <a href="{{ image.image.url }}" data-fancybox="gallery" title="{{ product.title }}">
                        <img src="{{ image.image.url }}" alt="{{ product.title }}" style="width:100%; height:400px; object-fit:cover; border-radius:10px;">
                      </a>
                    </figure>
                    {% endfor %}
                  </div>
                  {% else %}
                  <figure class="image-box">
                    <img src="{% static 'images/no-image.jpg' %}" alt="No Image" style="width:100%; height:400px; object-fit:cover; border-radius:10px;">
                  </figure>
                  {% endif %}
                </div>
                <!-- Product Info -->
                <div class="info-column col-md-6 col-sm-6 col-xs-12">
                  <div class="details-header">
                    <h4>{{ product.title }}</h4>
                    <p><strong>Category:</strong> {{ product.category.name }}</p>
                  </div>
                  <div class="text">
                    <p>{{ product.short_description }}</p>
                  </div>
                  <p>
                   <span class="sku-badge">{{ product.sku }}
                   </span>
                      </p>
                  <p><strong>Availability:</strong>
                    {% if product.availability %}
                      <span style="color:green;">In Stock</span>
                    {% else %}
                      <span style="color:red;">Out of Stock</span>
                    {% endif %}
                  </p>
                  {% if whatsapp_number %}

                <a href="https://wa.me/{{ whatsapp_number|urlencode }}?text={{ whatsapp_message|urlencode }}"
                  class="whatsapp-cta"
                  target="_blank"
                  rel="noopener noreferrer">
                    <div class="icon">
                        <i class="fa fa-whatsapp"></i>
                    </div>
                    <div class="text">
                        <span class="small-text">
                            Chat with me at {{ whatsapp_number }}
                            <span class="status">Online</span>
                        </span>
                        <span class="main-text">Ask me about {{ product.title|truncatechars:15 }}</span>
                    </div>
                </a>
                {% endif %}

                </div>
              </div>
            </div>
            <!-- Related / Category Products -->
            <div class="related-products mt-5">
             <h2>{% if category %}Related Products{% else %}Related Products{% endif %}</h2>
              <div class="row clearfix">
                {% for related in related_products %}
                <div class="shop-item col-lg-4 col-md-6 col-sm-6 col-xs-12">
                  <div class="inner-box">
                    <a href="{% url 'product_detail' related.id %}">
                      <div class="image-box">
                        {% with first_image=related.images.all|first %}
                          {% if first_image %}
                          <img src="{{ first_image.image.url }}" alt="{{ related.title }}" style="width:100%; height:250px; object-fit:cover; border-radius:8px;">
                          {% else %}
                          <img src="{% static 'images/no-image.jpg' %}" alt="No Image" style="width:100%; height:250px; object-fit:cover; border-radius:8px;">
                          {% endif %}
                        {% endwith %}
                      </div>
                      <div class="lower-content text-center">
                        <h4>{{ related.title|truncatewords:8 }}</h4>
                      </div>
                    </a>
                  </div>
                </div>
                {% empty %}
                <div class="col-12 text-center">
                  <p>No products found.</p>
                </div>
                {% endfor %}
              </div>
            </div>

          </div>
        </div>
      </div>


      <!-- Sidebar -->
      <div class="sidebar-side col-lg-3 col-md-4 col-sm-12 col-xs-12">
        <aside class="sidebar shop-sidebar">

          

          <!-- Categories -->
          <div class="sidebar-widget sidebar-blog-category">
           <div class="sidebar-title fancy-title"><h2>Categories</h2></div>
            <ul class="blog-cat">
              <li class="{% if not category %}active{% endif %}">
                <a href="{% url 'products' %}">View All</a>
              </li>

              {% for cat in categories %}
              <li class="{% if cat.id|stringformat:'s' == category %}active{% endif %}">
                <a href="{% url 'products' %}?category={{ cat.id }}{% if search_query %}&q={{ search_query }}{% endif %}">
                  {{ cat.name }}
                </a>
              </li>
              {% endfor %}
            </ul>
          </div>

        </aside>
      </div>

    </div>
  </div>
</div>

{% endblock %}
